## 47 | 原型模式：如何最快速地clone一个HashMap散列表？
### 一、原型模式的原理与应用
1、如果对象的创建成本比较大，而同一个类的不同对象之间差别不大(大部分字段都相同)，可以利用对已有对象(原型)进行复制(或者叫拷贝)的方式，来创建新对象，以达到节省创建时间的目的。这种基于原型来创建对象的方式就叫做原型设计模式。  
2、何为“对象的创建成本比较大”？  
(1)创建对象包含的申请内存、给成员变量赋值这一过程，不会花费太多时间。  
(2)如果对象中的数据需要经过复杂的计算才能得到(比如排序、计算哈希值)或者需要从RPC、网络、数据库、文件系统等非常慢速的IO中读取，就会消耗比较大的时间。

### 二、原型模式的实现方式：深拷贝和浅拷贝
1、原型模式有两种实现方法，深拷贝和浅拷贝。浅拷贝只会复制对象中基本数据类型数据和引用对象的内存地址，而深拷贝得到的是完完全全独立的对象。所以深拷贝比浅拷贝更加耗时，更加耗内存空间。  
2、如果要拷贝不可变对象，浅拷贝共享不可变对象是没问题的。但对于可变对象来说，浅拷贝得到的对象和原始对象会共享部分数据，就有可能出现数据被修改的风险。  
3、如何实现深拷贝？  
(1)递归拷贝对象、对象的引用对象以及引用对象的引用对象...直到要拷贝的对象只包含基本数据类型数据，没有引用对象为止。  
(2)先将对象序列化，然后再反序列化成新的对象。  


