## 82 | 开源实战三（中）：剖析Google Guava中用到的几种设计模式
### 一、Builder模式在Guava中的应用
1、Google Guava提供了现成的缓存工具类com.google.common.cache.*。Cache对象是通过CacheBuilder类来创建的。  
2、为了避免构造函数的参数列表过长、不同的构造函数过多，一般有两种解决方案。一是使用builder模式，二是先通过无参构造函数创建对象，然后再通过set方法赋值。  
3、当构造对象时，需要做一些必要的参数校验，需要用builder模式创建。

### 二、Wrapper模式在Guava中的应用
1、Guava提供一系列缺省的Forwarding类。用户在实现自己的Wrapper类的时候，基于缺省的Forwarding类来扩展，就可以只实现自己关心的方法，其他不关心的方法使用缺省的Forwarding类的实现。  
2、AddLoggingCollection是基于代理模式实现的一个代理类，它在原始Collection类的基础之上，针对“add”相关的操作，添加了记录日志的功能。   
3、代理模式、装饰器模式、适配器模式可以统称为Wrapper模式，通过Wrapper类二次封装原始类。通过组合的实现方式，将Wrapper类的函数实现委托给原始类的函数来实现。

### 三、Immutable模式在Guava中的应用
1、一个对象的状态在对象创建之后就不再改变，这就是不变模式。其中涉及的类就是不变类，对象就是不变对象。在Java中最常用的不变类就是String类。  
2、不变模式可以分为两类，一类是普通不变模式，一类是深度不变模式。普通不变模式指的是对象中包含的引用对象是可以改变的，深度不变模式指的是对象包含的引用对象也不可变。它们两个之间的关系，类似浅拷贝和深拷贝。  
3、如何将一个类变成不变类？所有的成员变量都通过构造函数一次性设置好，不暴露任何set等修改成员变量的方法。  